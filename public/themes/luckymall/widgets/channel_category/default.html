<div id="channel_category_handle">
  <div class="channel_category" id="category_box" >
    <div class="category-big-title"><hr><span>服装商品分类</span></div>
    <ul class="category-primary">
      <{foreach from=$data.data item=item key=key}>
      <{foreach from=$item.lv2 item=lv2item key=lv2key}>
        <li>
          <div class="category-relative">
            <div class="category-title"><{$lv2item.cat_name}></div>
            <div class="category-item">
              <{foreach from=$lv2item.lv3 item=lv3item key=lv3key}>
              <a href="<{url action=topc_ctl_list@index cat_id=$lv3item.cat_id}>"><{$lv3item.cat_name}></a>
              <{/foreach}>
            </div>
          </div>
          <div class="category-sub">
            <div class="category-sub-item">
              <div class="category-sub-title">全部分类</div>
              <ul>
                <{foreach from=$lv2item.lv3 item=lv3item key=lv3key}>
                <li><a href="<{url action=topc_ctl_list@index cat_id=$lv3item.cat_id}>"><{$lv3item.cat_name}></a></li>
                <{/foreach}>
              </ul>
            </div>
          </div>
        </li>
      <{/foreach}>
      <{/foreach}>
    </ul>
  </div>
</div>
<script>
<{if !$data.isindex}>  
  var category = $('#category_box');
  $('#category_handle').on('mouseover', function(e){
      category.css('visibility','visible');
  }).on('mouseout', function(e){
      category.css('visibility','hidden');
  });
<{/if}>
$('#channel_category_handle').on('mouseover', 'li', function(){
  $(this).find('.category-primary-item').addClass('on');
}).on('mouseout', 'li', function(){
  $(this).find('.category-primary-item').removeClass('on');
})
// <style>
// .category .category-sub{
//     width: <{$setting.sub_category_width}>px;
// }
// </style>
//全部商品分类hover时sub category的定位
// $('.category-primary li').hover(
//   function(){
//     var subCate = $(this).find('.category-sub');
//     var primCate = $(this).parent('.category-primary');

//     var subCateHeight = $(subCate).height();
//     var primCateHeight = $(primCate).height();

//     var subCateTop = $(subCate).offset().top;
//     var primCateTop = $(primCate).offset().top;

//     var subCateY = subCateTop+subCateHeight;
//     var primCateY = primCateTop+primCateHeight;

//     if(subCateY>primCateY){
//       $(this).css('position','static');
//       subCate.css({'bottom':'0','top':'initial'});        
//     }
//   }
// );
</script>
